<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Download</title>
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'nonce-{{nonce}}'; style-src 'self' 'unsafe-inline'; img-src 'self'; connect-src 'self'; form-action 'self'; base-uri 'self';">
    <style>
        :root {
            --bg: #121212;
            --card: #1E1E1E;
            --text: #E0E0E0;
            --border: #FFFFFF;
            --accent: #00FF9D; /* Neon Mint */
            --accent-hover: #00CC7D;
            --font: 'Courier New', monospace;
        }
        * { box-sizing: border-box; }
        body { margin:0; min-height:100vh; display:grid; place-items:center; background:var(--bg); color:var(--text); font-family:var(--font); padding:20px; }
        
        .neo-box {
            background: var(--card);
            border: 2px solid var(--border);
            box-shadow: 6px 6px 0 0 var(--border);
            padding: 30px;
            width: min(450px, 95vw);
        }

        h2 { margin-top:0; word-break:break-all; border-bottom: 2px solid var(--border); padding-bottom: 15px; margin-bottom: 25px; color: var(--accent); }
        
        .btn {
            display: block;
            background: var(--accent);
            color: #000;
            text-align: center;
            padding: 18px;
            text-decoration: none;
            font-weight: 900;
            font-size: 1.2rem;
            border: 2px solid var(--border);
            box-shadow: 5px 5px 0 0 var(--border);
            margin: 30px 0;
            transition: transform 0.1s;
        }
        .btn:hover { background: var(--accent-hover); }
        .btn:active { transform: translate(2px,2px); box-shadow: 3px 3px 0 0 var(--border); }
        
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .box { border: 1px solid var(--border); padding: 12px; background: #252525; }
        .lbl { font-weight: bold; display: block; font-size: 0.75rem; margin-bottom: 8px; text-transform: uppercase; color: #888; }
        .val { font-weight: bold; font-size: 0.9rem; color: #fff; }
    </style>
</head>
<body>
    <div class="neo-box">
        <h2 id="safe-name">...</h2>
        
        <a class="btn" href="/d/{{token}}">DOWNLOAD_DATA</a>
        
        <div class="grid">
            <div class="box">
                <span class="lbl">SIZE</span>
                <span class="val" id="sz">{{size}}</span>
            </div>
            <div class="box">
                <span class="lbl">EXPIRES</span>
                <span class="val ts">{{expires}}</span>
            </div>
            <div class="box" style="grid-column:span 2">
                <span class="lbl">TOKEN_ID</span>
                <span class="val" style="font-size:0.8rem; font-family: monospace;">{{token}}</span>
            </div>
        </div>
    </div>
    
    <div id="raw" style="display:none;">{{filename}}</div>

    <script nonce="{{nonce}}">
        // Safe Text Extraction
        const raw = document.getElementById('raw').textContent;
        document.getElementById('safe-name').innerText = raw;
        document.title = raw;

        // Formatting
        document.querySelectorAll('.ts').forEach(el => {
            el.innerText = new Date(parseInt(el.innerText) * 1000).toLocaleString();
        });
        
        const el = document.getElementById('sz');
        let s = parseInt(el.innerText), u = ['B','KB','MB','GB'], i = 0;
        while(s >= 1024 && i < 3) { s /= 1024; i++; }
        el.innerText = s.toFixed(2) + ' ' + u[i];
    </script>
</body>
</html>

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Secure Drop - Download</title>
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'nonce-{{nonce}}'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; form-action 'self'; base-uri 'self';">
    <style>
        :root {
            --bg: #0a0a0a;
            --card: #0d0d0d;
            --text: #E0E0E0;
            --border: #FFFFFF;
            --accent: #B026FF;
            --accent-hover: #9000FF;
            --accent2: #FF6B35;
            --accent3: #00D4FF;
            --font: 'Courier New', monospace;
        }
        * { box-sizing: border-box; }

        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100vh); }
        }

        @keyframes glitch {
            0%, 100% { text-shadow: 2px 0 var(--accent2), -2px 0 var(--accent3); }
            25% { text-shadow: -2px 0 var(--accent2), 2px 0 var(--accent3); }
            50% { text-shadow: 2px 2px var(--accent2), -2px -2px var(--accent3); }
            75% { text-shadow: -2px 2px var(--accent2), 2px -2px var(--accent3); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        body { 
            margin: 0; 
            min-height: 100vh; 
            display: grid; 
            place-items: center; 
            background: var(--bg); 
            color: var(--text); 
            font-family: var(--font); 
            padding: 20px;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 20px 20px;
            pointer-events: none;
            z-index: 0;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            animation: scanline 6s linear infinite;
            pointer-events: none;
            z-index: 0;
            opacity: 0.15;
        }

        .container { position: relative; z-index: 1; }

        .side-text {
            position: fixed;
            font-size: 0.6rem;
            color: #222;
            letter-spacing: 0.3rem;
            text-transform: uppercase;
            white-space: nowrap;
        }

        .side-text.left {
            left: 20px;
            top: 50%;
            transform: rotate(-90deg) translateX(-50%);
            transform-origin: left center;
        }

        .side-text.right {
            right: 20px;
            top: 50%;
            transform: rotate(90deg) translateX(50%);
            transform-origin: right center;
        }

        .float-decor {
            position: fixed;
            font-size: 1.5rem;
            color: var(--accent3);
            opacity: 0.15;
            animation: float 3s ease-in-out infinite;
        }

        .float-decor:nth-child(1) { top: 10%; left: 5%; animation-delay: 0s; }
        .float-decor:nth-child(2) { top: 20%; right: 8%; animation-delay: 0.5s; }
        .float-decor:nth-child(3) { bottom: 15%; left: 10%; animation-delay: 1s; }
        .float-decor:nth-child(4) { bottom: 25%; right: 5%; animation-delay: 1.5s; }

        .neo-box {
            background: var(--card);
            border: 3px solid var(--border);
            box-shadow: 
                8px 8px 0 0 var(--border),
                0 0 30px rgba(0, 212, 255, 0.1);
            padding: 35px;
            width: min(540px, 95vw);
            position: relative;
        }

        .neo-box::before {
            content: '[ FILE::READY ] ─── [ INTEGRITY::VERIFIED ] ─── [ DECRYPTION::ENABLED ]';
            position: absolute;
            top: -30px;
            left: 0;
            right: 0;
            font-size: 0.55rem;
            color: var(--accent3);
            white-space: nowrap;
            overflow: hidden;
            text-align: center;
            letter-spacing: 0.1rem;
        }

        .neo-box::after {
            content: '└────────────────────────────────────────────────────────────────┘';
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.5rem;
            color: #333;
            white-space: nowrap;
        }

        .header {
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 3px solid var(--border);
            padding-bottom: 15px;
            margin-bottom: 15px;
            position: relative;
        }

        .header::after {
            content: 'RETRIEVAL';
            position: absolute;
            right: 0;
            top: 0;
            font-size: 0.6rem;
            color: #444;
        }

        .header-icon {
            font-size: 1.8rem;
            color: var(--accent2);
            animation: pulse 2s infinite;
            text-shadow: 0 0 10px var(--accent2);
        }

        h1 { 
            margin: 0; 
            letter-spacing: -1px; 
            font-size: 1.3rem;
        }

        .terminal-line {
            font-size: 0.65rem;
            color: #0f0;
            margin-bottom: 15px;
            padding: 8px 12px;
            background: #000;
            border-left: 3px solid #0f0;
            font-family: monospace;
        }

        .terminal-line::before {
            content: '> ';
            color: var(--accent3);
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            font-size: 0.65rem;
            color: #555;
            margin-bottom: 25px;
            padding: 10px 12px;
            background: #000;
            border: 1px solid #222;
            position: relative;
        }

        .status-bar::before {
            content: '◈';
            position: absolute;
            left: -8px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent3);
            font-size: 0.8rem;
        }

        .status-bar .ready { color: #0f0; animation: blink 1s step-end infinite; }
        .status-bar .ready::before { content: '● '; }

        .file-icon {
            text-align: center;
            font-size: 4rem;
            margin: 25px 0;
            color: var(--accent);
            text-shadow: 0 0 30px var(--accent);
            position: relative;
        }

        .file-icon::before {
            content: '◢━━━◣';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.6rem;
            color: #333;
        }

        .file-icon::after {
            content: '◥━━━◤';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.6rem;
            color: #333;
        }

        .file-name {
            text-align: center;
            font-size: 1rem;
            font-weight: bold;
            word-break: break-all;
            padding: 15px 20px;
            background: #000;
            border: 2px solid var(--accent);
            margin-bottom: 25px;
            color: var(--accent);
            box-shadow: 0 0 15px rgba(176, 38, 255, 0.2);
        }

        .file-name::before { content: '>> '; color: var(--accent3); }

        .meta-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 25px;
        }

        .meta-item {
            background: #080808;
            border: 2px solid #333;
            padding: 14px;
            position: relative;
        }

        .meta-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--accent3);
        }

        .meta-item::after {
            content: '◈';
            position: absolute;
            top: 5px;
            right: 8px;
            font-size: 0.5rem;
            color: #333;
        }

        .meta-label {
            font-size: 0.6rem;
            color: var(--accent3);
            text-transform: uppercase;
            letter-spacing: 0.15rem;
            margin-bottom: 6px;
        }

        .meta-label::before { content: '//'; color: #444; margin-right: 4px; }

        .meta-value {
            font-size: 0.9rem;
            font-weight: bold;
        }

        .divider {
            text-align: center;
            margin: 20px 0;
            font-size: 0.5rem;
            color: #333;
            letter-spacing: 0.3rem;
        }

        button, a.btn {
            display: block;
            width: 100%;
            padding: 18px;
            background: var(--accent);
            color: #000;
            border: 3px solid var(--border);
            font-family: inherit;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow: 5px 5px 0 0 var(--border);
            transition: all 0.1s;
            text-transform: uppercase;
            letter-spacing: 0.15rem;
            text-decoration: none;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        a.btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
        }

        a.btn:hover::before {
            animation: shimmer 0.5s forwards;
        }

        @keyframes shimmer {
            to { left: 100%; }
        }

        button:hover, a.btn:hover { 
            background: var(--accent-hover); 
            color: #fff;
            transform: translate(2px, 2px); 
            box-shadow: 3px 3px 0 0 var(--border); 
        }

        .back-link {
            display: block;
            text-align: center;
            margin-top: 20px;
            color: #555;
            text-decoration: none;
            font-size: 0.8rem;
            padding: 12px;
            border: 1px solid transparent;
            transition: all 0.2s;
        }

        .back-link:hover {
            color: var(--accent3);
            border-color: var(--accent3);
        }

        .footer-decoration {
            text-align: center;
            margin-top: 20px;
            font-size: 0.5rem;
            color: #222;
            letter-spacing: 0.3rem;
        }

        .footer-credits {
            text-align: center;
            margin-top: 12px;
            font-size: 0.75rem;
            color: #444;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .github-link {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: #555;
            text-decoration: none;
            transition: color 0.2s;
        }

        .github-link:hover {
            color: var(--accent);
        }

        .github-link svg {
            transition: transform 0.2s;
        }

        .github-link:hover svg {
            transform: scale(1.1);
        }

        .author {
            color: #444;
        }

        .corner-decoration {
            position: absolute;
            font-size: 1.5rem;
            color: var(--accent2);
            opacity: 0.2;
        }
        .corner-decoration.tl { top: -35px; left: -15px; }
        .corner-decoration.tr { top: -35px; right: -15px; }
        .corner-decoration.bl { bottom: -35px; left: -15px; }
        .corner-decoration.br { bottom: -35px; right: -15px; }

        .warning-box {
            background: rgba(255, 107, 53, 0.1);
            border: 2px solid var(--accent2);
            padding: 14px;
            margin-top: 20px;
            font-size: 0.7rem;
            text-align: center;
            color: var(--accent2);
            position: relative;
        }

        .warning-box::before {
            content: '◈ ';
            animation: blink 0.5s step-end infinite;
        }

        .warning-box::after {
            content: ' ◈';
            animation: blink 0.5s step-end infinite;
        }

        .hacker-text {
            font-size: 0.55rem;
            color: #1a1a1a;
            text-align: center;
            margin-top: 15px;
            letter-spacing: 0.2rem;
        }

        .mode-toggle {
            position: fixed;
            bottom: 10px;
            right: 10px;
            width: 8px;
            height: 8px;
            background: transparent;
            border: none;
            cursor: pointer;
            opacity: 0;
        }

        .mode-toggle:hover { opacity: 0.1; background: var(--accent); }

        body.minimal { background: #111 !important; }
        body.minimal::before, body.minimal::after { display: none !important; }
        body.minimal .side-text,
        body.minimal .float-decor,
        body.minimal .corner-decoration,
        body.minimal .terminal-line,
        body.minimal .hacker-text,
        body.minimal .footer-decoration,
        body.minimal .status-bar::before { display: none !important; }
        body.minimal .neo-box::before,
        body.minimal .neo-box::after,
        body.minimal .file-icon::before,
        body.minimal .file-icon::after,
        body.minimal .meta-item::after { display: none !important; }
        body.minimal .neo-box { 
            box-shadow: 6px 6px 0 0 var(--border) !important;
            background: #1a1a1a !important;
        }
        body.minimal h1 { animation: none !important; text-shadow: none !important; }
        body.minimal .meta-label::before { display: none !important; }
        body.minimal .file-name::before { display: none !important; }
        body.minimal .warning-box::before,
        body.minimal .warning-box::after { display: none !important; }
    </style>
</head>
<body class="minimal">
    <div class="float-decor">◈</div>
    <div class="float-decor">◇</div>
    <div class="float-decor">⬡</div>
    <div class="float-decor">◆</div>

    <div class="side-text left">ENCRYPTED FILE DOWNLOAD ◈ PRIVATE ◈ SECURE</div>
    <div class="side-text right">END-TO-END ENCRYPTION ◈ AUTO-EXPIRING LINKS</div>

    <div class="container">
        <span class="corner-decoration tl">▛</span>
        <span class="corner-decoration tr">▜</span>
        <div class="neo-box">
            <div class="header">
                <h1>FILE DOWNLOAD</h1>
            </div>
            
            
            
            

            <div class="file-icon">◆</div>

            <div class="file-name">{{filename}}</div>

            <div class="meta-grid">
                <div class="meta-item">
                    <div class="meta-label">FILE SIZE</div>
                    <div class="meta-value" id="size">{{size}}</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">DOWNLOADS</div>
                    <div class="meta-value" id="downloads">{{downloads}}</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">UPLOADED</div>
                    <div class="meta-value" id="uploaded">{{uploaded}}</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">EXPIRES</div>
                    <div class="meta-value" id="expires">{{expires}}</div>
                </div>
            </div>

            <div class="divider">══════════════════════════════════════════</div>

            <a href="/d/{{token}}" class="btn">▶ DOWNLOAD FILE</a>

            <a href="/" class="back-link">◄ BACK TO UPLOAD</a>

            <div class="warning-box">
                Expires in <strong id="ttl-days">{{ttl_days}} days</strong> — download before deletion
            </div>

            

            <div class="footer-decoration">═══════════════════════════════════════════</div>
            
            <div class="footer-credits">
                <a href="https://github.com/AliEmreSenel/FileShare" target="_blank" rel="noopener" class="github-link">
                    <svg height="16" width="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                    </svg>
                    GitHub
                </a>
                <span class="author">by Ali Emre Senel</span>
            </div>
        </div>
        <span class="corner-decoration bl">▙</span>
        <span class="corner-decoration br">▟</span>
    </div>

    <button class="mode-toggle" id="mode-toggle" title="Toggle minimal mode"></button>

    <script nonce="{{nonce}}">
        const formatDate = (seconds) => {
            const ts = Number(seconds);
            if (!Number.isFinite(ts) || ts <= 0) return '—';
            return new Date(ts * 1000).toLocaleString(undefined, {
                year: 'numeric',
                month: 'short',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        };

        const formatBytes = (bytes) => {
            const n = Number(bytes);
            if (!Number.isFinite(n) || n < 0) return '—';
            if (n < 1024) return `${n} B`;
            const units = ['KB', 'MB', 'GB', 'TB'];
            const e = Math.min(units.length - 1, Math.floor(Math.log(n) / Math.log(1024)) - 0);
            const val = n / 1024 ** (e + 1);
            return `${val.toFixed(val >= 10 ? 0 : 1)} ${units[e]}`;
        };

        document.getElementById('uploaded').innerText = formatDate('{{uploaded}}');
        document.getElementById('expires').innerText = formatDate('{{expires}}');
        document.getElementById('size').innerText = formatBytes('{{size}}');
        document.getElementById('downloads').innerText = '{{downloads}}';
        document.getElementById('ttl-days').innerText = `${Number('{{ttl_days}}') || '—'} days`;

        // Secret mode toggle (click or press M)
        const toggleMinimal = () => {
            document.body.classList.toggle('minimal');
            localStorage.setItem('minimalMode', document.body.classList.contains('minimal'));
        };
        document.getElementById('mode-toggle').addEventListener('click', toggleMinimal);
        document.addEventListener('keydown', (e) => {
            const tag = e.target.tagName.toLowerCase();
            if ((e.key === 'm' || e.key === 'M') && tag !== 'input' && tag !== 'textarea') {
                toggleMinimal();
            }
        });

        if (localStorage.getItem('minimalMode') === 'true') {
            document.body.classList.add('minimal');
        }
    </script>
</body>
</html>

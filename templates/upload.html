<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Secure Drop</title>
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'nonce-{{nonce}}'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; form-action 'self'; base-uri 'self';">
    <style>
        :root {
            --bg: #121212;
            --card: #1E1E1E;
            --text: #E0E0E0;
            --border: #FFFFFF;
            --accent: #B026FF; /* Neon Purple */
            --accent-hover: #9000FF;
            --font: 'Courier New', monospace;
        }
        * { box-sizing: border-box; }
        body { margin:0; min-height:100vh; display:grid; place-items:center; background:var(--bg); color:var(--text); font-family:var(--font); padding:20px; }

        .neo-box {
            background: var(--card);
            border: 2px solid var(--border);
            box-shadow: 6px 6px 0 0 var(--border);
            padding: 30px;
            width: min(450px, 95vw);
        }

        h1 { margin-top:0; border-bottom: 2px solid var(--border); padding-bottom: 15px; letter-spacing: -1px; }

        .p2p-link {
            display: block;
            text-align: center;
            margin-bottom: 20px;
            padding: 12px;
            background: #FF6B35;
            color: #000;
            text-decoration: none;
            font-weight: bold;
            border: 2px solid var(--border);
            box-shadow: 4px 4px 0 0 var(--border);
        }
        .p2p-link:hover { background: #00D4FF; }

        label { display: block; margin-bottom: 8px; font-weight: bold; font-size: 0.9rem; color: var(--accent); }

        select, button {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            background: #2A2A2A;
            color: var(--text);
            border: 2px solid var(--border);
            font-family: inherit;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 4px 4px 0 0 var(--border);
        }

        select:focus, button:focus { outline: none; transform: translate(2px, 2px); box-shadow: 2px 2px 0 0 var(--border); }

        button { background: var(--accent); color: #000; text-transform: uppercase; font-size: 1.1rem; }
        button:hover { background: var(--accent-hover); color: #fff; }

        #drop-zone {
            border: 2px dashed var(--border);
            background: #252525;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 25px;
            cursor: pointer;
            transition: all 0.2s;
        }

        #drop-zone.hover { background: var(--accent); color: #000; border-style: solid; }

        #file-display {
            display: none;
            margin-top: 15px;
            padding: 10px;
            background: #000;
            border: 1px solid var(--border);
            color: var(--accent);
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="neo-box">
        <h1>>>> ENCRYPT_UPLOAD</h1>
        
        <a href="/p2p" class="p2p-link">âš¡ P2P DIRECT TRANSFER (No server storage)</a>
        
        <form action="/u" method="post" enctype="multipart/form-data">
            <label>EXPIRATION_TTL:</label>
            <select name="ttl">
                <option value="1">1 Day</option>
                <option value="7" selected>7 Days</option>
                <option value="30">30 Days</option>
            </select>

            <div id="drop-zone">
                <span id="lbl">[ DROP FILE HERE ]<br><br>OR CLICK TO BROWSE</span>
                <input type="file" name="file" id="f" required style="display:none"/>
                <div id="file-display"></div>
            </div>

            <button type="submit">INITIATE SEQUENCE</button>
        </form>
    </div>

    <script nonce="{{nonce}}">
        const d = document.getElementById('drop-zone');
        const f = document.getElementById('f');
        const lbl = document.getElementById('lbl');
        const n = document.getElementById('file-display');

        const update = (file) => {
            const dT = new DataTransfer(); dT.items.add(file); f.files = dT.files;
            lbl.innerText = ">> TARGET LOCKED <<";
            n.innerText = file.name;
            n.style.display = 'block';
            d.style.borderStyle = 'solid';
            d.style.borderColor = 'var(--accent)';
        };

        ['dragenter','dragover'].forEach(e => d.addEventListener(e, (ev)=>{ ev.preventDefault(); d.classList.add('hover'); }));
        ['dragleave','drop'].forEach(e => d.addEventListener(e, (ev)=>{ ev.preventDefault(); d.classList.remove('hover'); }));
        d.addEventListener('drop', (e) => { if(e.dataTransfer.files[0]) update(e.dataTransfer.files[0]); });
        d.addEventListener('click', () => f.click());
        f.addEventListener('change', () => { if(f.files[0]) update(f.files[0]); });
    </script>
</body>
</html>
